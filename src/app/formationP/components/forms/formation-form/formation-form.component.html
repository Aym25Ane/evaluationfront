<!-- src/app/forms/formation-form/formation-form.component.html -->

<div class="card shadow-sm border-0">
  <div class="card-body p-4">
    <div class="row g-4">

      <!-- TITRE -->
      <div class="col-12">
        <label class="form-label fw-bold">Titre de la formation</label>
        <input type="text"
               class="form-control form-control-lg"
               [(ngModel)]="formation.titre"
               (ngModelChange)="onModelChange()"
               placeholder="Ex: Angular Avancé">
      </div>

      <!-- DESCRIPTION -->
      <div class="col-12">
        <label class="form-label fw-bold">Description</label>
        <textarea class="form-control"
                  rows="4"
                  [(ngModel)]="formation.description"
                  (ngModelChange)="onModelChange()"></textarea>
      </div>

      <!-- NIVEAU -->
      <div class="col-md-6">
        <label class="form-label fw-bold">Niveau</label>
        <input type="text"
               class="form-control"
               [(ngModel)]="formation.niveau"
               (ngModelChange)="onModelChange()">
      </div>

      <!-- CATEGORIE -->
      <div class="col-md-6">
        <label class="form-label fw-bold">Catégorie</label>

        @if (isLoadingCategories()) {
          <div class="text-muted">Chargement des catégories...</div>
        } @else {
          <select class="form-select"
                  [ngModel]="formation.categorie?.id"
                  (ngModelChange)="onCategorieChange($event)">
            <option value="" disabled selected>-- Sélectionner une catégorie --</option>
            @for (cat of categories(); track cat.id) {
              <option [value]="cat.id">{{ cat.name }}</option>
            }
          </select>
        }
      </div>

      <!-- IMAGE -->
      <div class="col-md-6">
        <label class="form-label fw-bold">Image de couverture</label>

        <input type="file"
               class="form-control"
               accept="image/*"
               (change)="onImageSelected($event)"
               [disabled]="isUploading()">

        @if (isUploading()) {
          <div class="mt-2 text-primary d-flex align-items-center">
            <span class="spinner-border spinner-border-sm me-2"></span>
            Upload en cours...
          </div>
        }

        <div class="mt-3">
          @if (imagePreview()) {
            <img [src]="imagePreview()!" class="img-fluid rounded border" style="max-height:200px">
          } @else if (formation.image) {
            <img [src]="formation.image" class="img-fluid rounded border" style="max-height:200px">
          }
        </div>
      </div>

    </div>
  </div>
</div>
